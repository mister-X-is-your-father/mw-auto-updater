# mw-auto-updater

ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æ™‚ã«å¿…è¦ãªå¤‰æ›´ç‚¹ã‚’è‡ªå‹•ã§æŠ½å‡ºã™ã‚‹ãƒ„ãƒ¼ãƒ«ã€‚

## ä»•çµ„ã¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  config.toml    â”‚â”€â”€â”€â”€>â”‚ mw-upgrade-check â”‚â”€â”€â”€â”€>â”‚  JSON / Text    â”‚
â”‚  (è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«)   â”‚     â”‚     .py          â”‚     â”‚  (å¤‰æ›´ç‚¹ä¸€è¦§)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                         â”‚
              â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ data/*.tomlâ”‚           â”‚  Web Fetch    â”‚
              â”‚ (ãƒ­ãƒ¼ã‚«ãƒ«)  â”‚           â”‚ (php.watchç­‰) â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

1. **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«èª­è¾¼**: `config.toml` ã‹ã‚‰å¯¾è±¡ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¨ç¾åœ¨/ç›®æ¨™ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—
2. **å¤‰æ›´ç‚¹å–å¾—**: ãƒ­ãƒ¼ã‚«ãƒ«TOMLãƒ‡ãƒ¼ã‚¿ã‚’å„ªå…ˆã—ã€ãªã‘ã‚Œã°Webã‹ã‚‰å–å¾—
3. **åˆ†é¡ãƒ»å‡ºåŠ›**: ç ´å£Šçš„å¤‰æ›´ãƒ»éæ¨å¥¨ãƒ»å‰Šé™¤ãƒ»æ–°æ©Ÿèƒ½ã«åˆ†é¡ã—ã¦JSON/ãƒ†ã‚­ã‚¹ãƒˆå‡ºåŠ›

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
git clone https://github.com/mister-X-is-your-father/mw-auto-updater.git
cd mw-auto-updater

# uv ã§ä»®æƒ³ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
uv sync

# ã¾ãŸã¯ç›´æ¥å®Ÿè¡Œ
uv run mw-upgrade-check --output=text
```

ä¾å­˜: Python 3.9+, [uv](https://docs.astral.sh/uv/) (æ¨å¥¨), jq (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)

## ä½¿ã„æ–¹

### 1. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†

```toml
# config.toml
[[middleware]]
name = "php"
current = "8.2"      # ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
target = "^8.5"      # ç›®æ¨™ãƒãƒ¼ã‚¸ãƒ§ãƒ³ (^8.5 = 8.5.x)
```

### 2. å®Ÿè¡Œ

```bash
# ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã§å‡ºåŠ›ï¼ˆäººé–“ãŒèª­ã¿ã‚„ã™ã„ï¼‰
uv run mw-upgrade-check --output=text

# JSONå½¢å¼ã§å‡ºåŠ›ï¼ˆAI/ã‚¹ã‚¯ãƒªãƒ—ãƒˆé€£æºç”¨ï¼‰
uv run mw-upgrade-check

# ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ã¿ä½¿ç”¨ï¼ˆWebãƒ•ã‚§ãƒƒãƒãªã—ï¼‰
uv run mw-upgrade-check --no-web
```

### 3. å‡ºåŠ›ä¾‹

```
============================================================
Middleware: PHP
Upgrade: 8.2 â†’ 8.5
============================================================

Summary:
  Total changes: 40
  Breaking:      4
  Deprecations:  23

âš ï¸  BREAKING CHANGES:
  [8.3] mb_strimwidth() behavior change
  [8.4] exit() and die() are now proper language constructs

âš¡ DEPRECATIONS:
  [8.3] Dynamic properties are deprecated
       â†’ Use declared properties or #[AllowDynamicProperties]
  [8.5] Backtick operator (shell_exec alias) is deprecated
       â†’ Use shell_exec() function instead
```

## AIé€£æºã§ã®ä½¿ç”¨ä¾‹

```bash
# å¤‰æ›´ç‚¹ã‚’å–å¾—ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã‚’æ¤œç´¢
uv run mw-upgrade-check | jq -r '.[].deprecations[].pattern | select(. != null)' | while read p; do
  grep -rn "$p" ./your-project/src/ 2>/dev/null
done
```

## å¯¾å¿œãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢

| Name | Status | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ |
|------|--------|-------------|
| PHP  | âœ… å¯¾å¿œ | ãƒ­ãƒ¼ã‚«ãƒ« + php.watch |
| Laravel | ğŸš§ è¨ˆç”»ä¸­ | - |
| MySQL | ğŸš§ è¨ˆç”»ä¸­ | - |

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
mw-auto-updater/
â”œâ”€â”€ pyproject.toml         # uv/Python ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š
â”œâ”€â”€ config.toml            # ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢è¨­å®š
â”œâ”€â”€ mw_upgrade_check.py    # ãƒ¡ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«
â”œâ”€â”€ php-upgrade-check.sh   # ã‚·ã‚§ãƒ«ç‰ˆ (ãƒ¬ã‚¬ã‚·ãƒ¼)
â””â”€â”€ data/
    â”œâ”€â”€ php-8.3-changes.toml
    â”œâ”€â”€ php-8.4-changes.toml
    â””â”€â”€ php-8.5-changes.toml
```

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT
